#!/bin/sh

die() {
  /usr/bin/printf '%s\n' "$1" >&2
  exit 1
}

# Steven Black
src1='https://raw.githubusercontent.com/StevenBlack/hosts/master/alternates/fakenews-gambling-porn/hosts'

# Dan Pollock
src2='https://someonewhocares.org/hosts/zero/'

# MVPS hosts
src3='https://winhelp2002.mvps.org/hosts.txt'

# My file with shitty Czech news sites
src4='https://raw.githubusercontent.com/tomaskala/dotfiles/master/.local/share/dns-blacklist'

/usr/bin/curl "${src1}" "${src2}" "${src3}" "${src4}" \
  | /usr/bin/grep '^0\.0\.0\.0' \
  | /usr/bin/grep -v '^0\.0\.0\.0  *0\.0\.0\.0$' \
  | /usr/bin/sort \
  | /usr/bin/uniq \
  | /usr/bin/sort \
  | /usr/bin/sed 's/\r//' \
  | /usr/bin/awk '{$1=$1;print}' \
  | /usr/bin/awk '{print "local-zone: \""$2".\" redirect\nlocal-data: \""$2". A 0.0.0.0\""}'
